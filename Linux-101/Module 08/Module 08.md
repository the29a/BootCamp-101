
# 8. Управление разрешениями
Обзор
---- 

В Linux разрешения назначаются пользователям и группам. Каждый пользователь может быть членом разных групп, и членство в этих группах дает пользователю определенные дополнительные разрешения.

Каждый файл и каталог принадлежит определенному пользователю и определенной группе. Таким образом, разрешения для пользователей и групп, которые определили файл, также определены для соответствующих владельцев. Когда мы создаем новые файлы или каталоги, они принадлежат к той группе, к которой мы принадлежим, и к нам. Вся система разрешений в системах Linux основана на восьмеричной системе счисления, и, по сути, существует три различных типа разрешений, которые могут быть назначены файлу или каталогу:

    (r) - Read
    (w) - Write
    (x) - Execute

Разрешения могут быть установлены для владельца, группы и других, как показано в следующем примере, с соответствующими разрешениями.
```
the29a@host[~]$ ls -l /etc/passwd

- rwx rw- r--   1 root root 1641 May  4 23:42 /etc/passwd
- --- --- ---   |  |    |    |   |__________|
|  |   |   |    |  |    |    |        |_ Date
|  |   |   |    |  |    |    |__________ File Size
|  |   |   |    |  |    |_______________ Group
|  |   |   |    |  |____________________ User
|  |   |   |    |_______________________ Number of hard links
|  |   |   |_ Permission of others (read)
|  |   |_____ Permissions of the group (read, write)
|  |_________ Permissions of the owner (read, write, execute)
|____________ File type (- = File, d = Directory, l = Link, ... )
```

Изменение разрешений
----

Мы можем изменить разрешения с помощью команды chmod, ссылок на группы разрешений (u - владелец, g - группа, o - другие, a - все пользователи) и либо [+], или [-], чтобы добавить удаление назначенных разрешений. В следующем примере пользователь создает новый сценарий оболочки, принадлежащий этому пользователю, а не исполняемый файл, и устанавливает для всех пользователей разрешения на чтение / запись.
```
the29a@host[~]$ ls -l shell

-rwxr-x--x   1 the29a the29a 0 May  4 22:12 shell
```
Затем мы можем применить разрешения на чтение для всех пользователей и увидеть результат.
```
the29a@host[~]$ chmod a+r shell && ls -l shell

-rwxr-xr-x   1 the29a the29a 0 May  4 22:12 shell
```
Мы также можем установить разрешения для всех других пользователей только на чтение, используя присвоение восьмеричного значения.
```
the29a@host[~]$ chmod 754 shell && ls -l shell

-rwxr-xr--   1 the29a the29a 0 May  4 22:12 shell
```

Давайте посмотрим на все связанные с ним представления, чтобы лучше понять, как рассчитывается назначение разрешений.
------------ | ------------- | ------------- |  -------------
Двоичная запись | 4 2 1 | 4 2 1 | 4 2 1 |
Двоичное представление | 1 1 1 | 1 0 1 | 1 0 0 | 
Восьмеричное значение | 7 | 5 | 4 |
Представление разрешения| r w x | г - х | r - - |

Если мы суммируем установленные биты из двоичного представления, назначенные значениям из двоичной нотации, мы получим восьмеричное значение.

Представление разрешений представляет биты, установленные в двоичном представлении, с помощью трех символов, что упрощает распознавание установленных разрешений.

Смена владельца
----

Чтобы изменить владельца и / или групповые назначения файла или каталога, мы можем использовать команду chown. Синтаксис такой:
```
the29a@host[~]$ chown <user>:<group> <file/directory>
```
В этом примере «shell» может быть заменена любым произвольным файлом или папкой.

```
the29a@host[~]$ chown root:root shell && ls -l shell

-rwxr-xr--   1 root root 0 May  4 22:12 shell
```

SUID и GUID
----
Помимо назначения прямых разрешений для пользователей и групп, мы также можем настроить специальные разрешения для файлов, установив биты Set User ID (SUID) и Set Group ID (GUID). Эти биты SUID/GUID позволяют, например, пользователям запускать программы с правами другого пользователя. Администраторы часто используют это, чтобы дать своим пользователям особые права на определенные приложения или файлы. Буква «s» используется вместо «x». При выполнении такой программы используется SUID/GUID владельца файла.

Часто администраторы не знакомы с приложениями, но все же назначают биты SUID/GUID, что ведет к высокому риску безопасности. Такие программы могут содержать функции, позволяющие запускать оболочку из пейджера, например приложение journalctl.

Если администратор устанавливает бит SUID на «journalctl», любой пользователь, имеющий доступ к этому приложению, может запускать оболочку как root. Более подробную информацию об этом и других подобных приложениях можно найти на GTFObins.
